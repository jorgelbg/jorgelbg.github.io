<!doctype html><html lang=en-us><head><link rel=preload href=//jorgelbg.me/css/style.css as=style><link rel=stylesheet href=//jorgelbg.me/css/style.css media=print onload="this.media='all'"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Jorge Luis Betancourt"><meta name=description content="Computo Ergo Sum"><meta name=generator content="Hugo 0.80.0"><title>Web UI for testing dissect patterns</title><link rel="shortcut icon" href=//jorgelbg.me/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=//jorgelbg.me/site.webmanifest><link rel=mask-icon href=//jorgelbg.me/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><link rel=dns-prefetch href=//www.google-analytics.com/><link href=//jorgelbg.me/index.xml rel=alternate type=application/rss+xml title="Jorge Luis Betancourt"><meta property="og:title" content="Web UI for testing dissect patterns"><meta property="og:description" content="Web UI tool for testing tokenizer strings for the dissect processor against a few logline samples."><meta property="og:type" content="article"><meta property="og:url" content="//jorgelbg.me/2020/02/web-ui-for-testing-dissect-patterns/"><meta property="article:published_time" content="2020-02-21T10:49:32+01:00"><meta property="article:modified_time" content="2020-05-06T12:33:26+02:00"><meta itemprop=name content="Web UI for testing dissect patterns"><meta itemprop=description content="Web UI tool for testing tokenizer strings for the dissect processor against a few logline samples."><meta itemprop=datePublished content="2020-02-21T10:49:32+01:00"><meta itemprop=dateModified content="2020-05-06T12:33:26+02:00"><meta itemprop=wordCount content="462"><meta itemprop=keywords content="filebeat,dissect,test,ui,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Web UI for testing dissect patterns"><meta name=twitter:description content="Web UI tool for testing tokenizer strings for the dissect processor against a few logline samples."><meta name=twitter:site content="@https://twitter.com/jorgelbg"></head><body><section id=wrapper><nav class=main-nav><a href=//jorgelbg.me></a></nav><article class=post><header><h1><a href=//jorgelbg.me/2020/02/web-ui-for-testing-dissect-patterns/><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="20"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>Web UI for testing dissect patterns</a></h1><h2 class=headline><span>February 21, 2020</span>
<span class=tag><svg fill="#718096" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16"><path class="heroicon-ui" d="M2.59 13.41A1.98 1.98.0 012 12V7a5 5 0 015-5h4.99c.53.0 1.04.2 1.42.59l8 8a2 2 0 010 2.82l-8 8a2 2 0 01-2.82.0l-8-8zM20 12l-8-8H7A3 3 0 004 7v5l8 8 8-8zM7 8a1 1 0 110-2 1 1 0 010 2z"/></svg><a style=margin-left:10px href=//jorgelbg.me/tags/filebeat>filebeat</a></span>
<span class=tag><svg fill="#718096" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16"><path class="heroicon-ui" d="M2.59 13.41A1.98 1.98.0 012 12V7a5 5 0 015-5h4.99c.53.0 1.04.2 1.42.59l8 8a2 2 0 010 2.82l-8 8a2 2 0 01-2.82.0l-8-8zM20 12l-8-8H7A3 3 0 004 7v5l8 8 8-8zM7 8a1 1 0 110-2 1 1 0 010 2z"/></svg><a style=margin-left:10px href=//jorgelbg.me/tags/dissect>dissect</a></span>
<span class=tag><svg fill="#718096" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16"><path class="heroicon-ui" d="M2.59 13.41A1.98 1.98.0 012 12V7a5 5 0 015-5h4.99c.53.0 1.04.2 1.42.59l8 8a2 2 0 010 2.82l-8 8a2 2 0 01-2.82.0l-8-8zM20 12l-8-8H7A3 3 0 004 7v5l8 8 8-8zM7 8a1 1 0 110-2 1 1 0 010 2z"/></svg><a style=margin-left:10px href=//jorgelbg.me/tags/test>test</a></span>
<span class=tag><svg fill="#718096" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16"><path class="heroicon-ui" d="M2.59 13.41A1.98 1.98.0 012 12V7a5 5 0 015-5h4.99c.53.0 1.04.2 1.42.59l8 8a2 2 0 010 2.82l-8 8a2 2 0 01-2.82.0l-8-8zM20 12l-8-8H7A3 3 0 004 7v5l8 8 8-8zM7 8a1 1 0 110-2 1 1 0 010 2z"/></svg><a style=margin-left:10px href=//jorgelbg.me/tags/ui>ui</a></span></h2><p class=last-edited><a href=https://github.com/jorgelbg/jorgelbg.github.io/commit/21f74ddb658495cda94f11b79e3db0b002d81f1c title="Add announcement about the availability of the CLI tool to the filebeat dissect testing article">Last edited on 6 May 2020</a></p></header><section id=post-body><picture>
<source type=image/webp srcset=/images/dissect-tester-announcement/log-patterns.webp><source type=image/png srcset=/images/dissect-tester-announcement/log-patterns.png><img src=/images/dissect-tester-announcement/log-patterns.png class=align-center alt="log patterns image" loading=lazy style=max-width:100%></picture><p>If you have been using <a href=https://www.elastic.co/beats/filebeat>Filebeat</a> to ship your logs around
(usually to <a href=https://www.elastic.co/elasticsearch>Elasticsearch</a>) you know that Filebeat
doesn&rsquo;t support Grok patterns (like
<a href=https://www.elastic.co/guide/en/logstash/current/plugins-filters-dissect.html>Logstash</a> does).
Instead, Filebeat advocates the usage of the <a href=https://www.elastic.co/guide/en/beats/filebeat/master/dissect.html>dissect
processor</a>.</p><div class="info announce"><svg width="150" viewBox="0 0 512 512"><circle cx="256" cy="475" r="27" fill="#f7911e"/><g fill="#d1d3d4"><path d="M99 244v-34H67v41m346-7v-34h32v41z"/></g><g fill="#4aa7ed"><path d="M114 244h-3a101 101 0 000 202h3V244zm284 0h3a101 101 0 010 202h-3V244z"/></g><path d="M456 210a2e2 2e2.0 00-4e2.0h64a136 136 0 01272 0h64z" fill="#f9ae18"/><path d="M78 306c6 0 10-5 10-10v-1a10 10 0 00-20 0v1c0 5 5 10 10 10zm0 99c6 0 10-4 10-10v-70a10 10 0 00-20 0v70c0 6 5 10 10 10zM434 285c-6 0-10 4-10 10v1a10 10 0 0020 0v-1c0-6-5-10-10-10zm0 30c-6 0-10 5-10 10v70a10 10 0 0020 0v-70c0-5-5-10-10-10z"/><path d="M455 248v-28h1c6 0 10-4 10-10a210 210 0 00-420 0c0 6 4 10 10 10h1v28a111 111 0 0012 2e2c2 21 21 38 43 38h109a37 37 0 10-1-20H112c-8 0-16-5-20-12l19 2h3c6 0 10-4 10-10V244a10 10 0 00-10-10h-5v-14h11c6 0 10-4 10-10a126 126 0 01252 0c0 6 4 10 10 10h11v14h-5a10 10 0 00-10 10v202c0 6 4 10 10 10h3a111 111 0 0054-208zM256 458a17 17 0 110 34 17 17 0 010-34zm-152-22a91 91 0 010-182v182zM89 236l-12 3v-19h12v16zM256 64c-77 0-140 60-146 136H66a190 190 0 01380 0h-44c-6-76-69-136-146-136zm167 156h12v19l-12-3v-16zm-15 216V254a91 91 0 010 182z"/></svg><div><p>A small CLI tool for local pattern testing is also available now. Releases are available in the
<a href=https://github.com/jorgelbg/dissect-tester/releases>Github Releases page</a>. After downloading and
decompressing the <code>.tar.gz</code> file the CLI can be executed as:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>$ dissect-tester/dissect-tester --pattern<span class=o>=</span><span class=s1>&#39;%{key1} %{key2}&#39;</span>
</code></pre></div><p>Test cases are accepted through <code>stdin</code> and for each test case the result will be sent directly into
<code>stdout</code>.</p></div></div><p>I like the dissect processor tokenization syntax. It is easy to understand and usually quite
fast at processing. This blog post is not about the decision of not supporting Grok patterns in
Filebeat.</p><p>If you work with Logstash (and use the <a href=https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html>grok
filter</a>). You might be
used to work with tools like <a href=https://regex101.com/>regex101.com</a> to tweak your regex and verify
that it matches your log lines. Beyond the regex there are similar tools focused on Grok
patterns:</p><ul><li><a href=https://grokdebug.herokuapp.com/>Grok Debugger</a></li><li><a href=https://www.elastic.co/guide/en/kibana/current/xpack-grokdebugger.html>Kibana</a></li><li><a href=https://grokconstructor.appspot.com/do/match>Grok Constructor</a></li></ul><p>These tools make it quite simple to just paste your pattern, a few log lines and verify that
everything is working as expected. I was missing something similar for the dissect processor
syntax.</p><p>I hear you: The syntax of the dissect processor is simpler than the regex format
supported by the Grok filter. I dont' disagree: If you check the example from
the dissect processor documentation:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>processors</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>dissect</span><span class=p>:</span><span class=w>
</span><span class=w>      </span><span class=nt>tokenizer</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;%{key1} %{key2}&#34;</span><span class=w>
</span><span class=w>      </span><span class=nt>field</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;message&#34;</span><span class=w>
</span><span class=w>      </span><span class=nt>target_prefix</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;dissect&#34;</span><span class=w>
</span></code></pre></div><p>It is quite easy to understand that the <code>tokenizer</code> is looking for 2 keys separated by a space. It is
less obvious that if we pass a string with multiple spaces (like <code>a b c</code>) <code>key2</code> will have the value
<code>b c</code>.</p><p>Let&rsquo;s see another example. If your logs are a bit more complicated (let&rsquo;s say like the <a href=https://www.envoyproxy.io/docs/envoy/latest/configuration/observability/access_log>Envoy
access log format</a>). You
might endup having a tokenizer like:</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=p>[</span><span class=o>%</span><span class=p>{</span><span class=nx>timestamp</span><span class=p>}]</span> <span class=s2>&#34;%{request}&#34;</span> <span class=o>%</span><span class=p>{</span><span class=nx>status</span><span class=p>}</span> <span class=o>-</span> <span class=o>%</span><span class=p>{</span><span class=nx>bytes_sent</span><span class=p>}</span> <span class=s2>&#34;%{forwarded_ips}&#34;</span>
<span class=s2>&#34;%{user_agent}&#34;</span> <span class=s2>&#34;%{unknown_id}&#34;</span> <span class=s2>&#34;%{destination_host}&#34;</span> <span class=s2>&#34;%{destination_address}&#34;</span>
</code></pre></div><p>with a log entry like:</p><pre><code>[2020-02-21T14:29:08.671Z] &quot;GET /stats?format=prometheus&amp;usedonly=1 HTTP/1.1&quot;
200 - 0 105150 6 - &quot;10.22.10.103&quot; &quot;Prometheus/2.7.0&quot; &quot;-&quot; &quot;10.22.10.121:12345&quot; &quot;-&quot;
</code></pre><p>That mix of quoted values makes it a bit harder to mentally parse the line, right?</p><p>That&rsquo;s why I built a small Web UI like <a href=https://grokdebug.herokuapp.com/>Grok Debugger</a>. Available
<a href=https://dissect-tester.jorgelbg.me>🚀 here</a> where you only need to put your pattern, a few samples
(one per line) and see the output on the result area. That&rsquo;s it!</p><picture>
<source type=image/webp srcset=/images/dissect-tester-announcement/screenshot.webp><source type=image/png srcset=/images/dissect-tester-announcement/screenshot.png><img src=/images/dissect-tester-announcement/screenshot.png class=align-center alt="screenshot of the UI" loading=lazy style=max-width:100%></picture><h2 id=final-thoughts>Final thoughts</h2><p>The source code for the app is <a href=https://github.com/jorgelbg/dissect-tester>available on Github</a>.
The app uses the latest version of the Filebeat dissect processor (currently v7.6.0).</p><p>You can play with the demo in <a href=https://dissect-tester.jorgelbg.me>https://dissect-tester.jorgelbg.me</a></p><p>Both
<a href=https://www.elastic.co/guide/en/elasticsearch/reference/master/dissect-processor.html>Elasticsearch</a>
and <a href=https://www.elastic.co/guide/en/logstash/current/plugins-filters-dissect.html>Logstash</a> also
have dissect filters/plugins. You should be able to use this tool for testing patterns for those
implementations as well, but keep in mind that we&rsquo;re using the Filebeat implementation under the hood.</p></section></article><footer id=post-meta class=clearfix><svg class="avatar" width="50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="#cbd5e0" d="M20.3 12.04l1.01 3a1 1 0 01-1.26 1.27l-3.01-1a7 7 0 113.27-3.27zM11 10a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2z"/><path fill="#4a5568" d="M15.88 17.8a7 7 0 01-8.92 2.5l-3 1.01a1 1 0 01-1.27-1.26l1-3.01A6.97 6.97.0 015 9.1a9 9 0 0010.88 8.7z"/></svg><a href=https://twitter.com/jorgelbg><div><span class=dark>Want to leave a comment?</span>
<span>Drop me a message on Twitter @jorgelbg</span></div></a><section id=sharing><a class=twitter target=_blank href="https://twitter.com/intent/tweet?text=%2f%2fjorgelbg.me%2f2020%2f02%2fweb-ui-for-testing-dissect-patterns%2f - Web%20UI%20for%20testing%20dissect%20patterns by @jorgelbg"><span class=icon-twitter>tweet</span></a></section></footer><ul id=post-list class="archive readmore"><h3>Read more</h3><li><a href=//jorgelbg.me/2021/08/introducing-pinentry-touchid/><span>Introducing pinentry-touchid</span><aside class=dates>Aug 3 2021</aside></a></li><li><a href=//jorgelbg.me/2020/03/displaying-geohash-tags-from-a-loki-datasource-in-a-grafana-worldmap-panel/><span>Displaying geohash tags from a Loki datasource in a Grafana Worldmap Panel</span><aside class=dates>Mar 18 2020</aside></a></li><li><a href=//jorgelbg.me/2020/01/better-url-search-with-elasticsearch/><span>Better URL search with Elasticsearch</span><aside class=dates>Jan 1 2020</aside></a></li></ul><footer id=footer><p class=small>© Copyright 2021 Jorge Luis Betancourt</p><p class="small cc">Icons made by
<a href=https://www.freepik.com/ title=Freepik>Freepik</a> from
<a href=https://www.flaticon.com/ title=Flaticon>www.flaticon.com</a> is
licensed by
<a href=https://creativecommons.org/licenses/by/3.0/ title="Creative Commons BY 3.0" target=_blank>CC 3.0 BY</a></p></footer></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-115201846-1','auto');ga('send','pageview');}</script></body></html>