<!doctype html><html lang=en-us><head><link rel=preload href=//jorgelbg.me/css/style.css as=style><link rel=stylesheet href=//jorgelbg.me/css/style.css media=print onload="this.media='all'"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Jorge Luis Betancourt"><meta name=description content="Computo Ergo Sum"><meta name=generator content="Hugo 0.60.1"><title>How to rename index patterns in Kibana</title><link rel="shortcut icon" href=//jorgelbg.me/images/favicon.ico><link rel=dns-prefetch href=//www.google-analytics.com/><link href=//jorgelbg.me/index.xml rel=alternate type=application/rss+xml title="Jorge Luis Betancourt"><meta property="og:title" content="How to rename index patterns in Kibana"><meta property="og:description" content="How to rename index patterns in Kibana without breaking your existing visualizations or dashboards."><meta property="og:type" content="article"><meta property="og:url" content="//jorgelbg.me/2019/05/how-to-rename-index-patterns-in-kibana/"><meta property="og:image" content="//jorgelbg.me/posts/2019/rename-kibana-index-patterns/kibana.png"><meta property="article:published_time" content="2019-05-21T17:00:00+02:00"><meta property="article:modified_time" content="2019-12-09T13:07:52+01:00"><meta itemprop=name content="How to rename index patterns in Kibana"><meta itemprop=description content="How to rename index patterns in Kibana without breaking your existing visualizations or dashboards."><meta itemprop=datePublished content="2019-05-21T17:00:00+02:00"><meta itemprop=dateModified content="2019-12-09T13:07:52+01:00"><meta itemprop=wordCount content="711"><meta itemprop=image content="//jorgelbg.me/posts/2019/rename-kibana-index-patterns/kibana.png"><meta itemprop=keywords content="kibana,index-pattern,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="//jorgelbg.me/posts/2019/rename-kibana-index-patterns/kibana.png"><meta name=twitter:title content="How to rename index patterns in Kibana"><meta name=twitter:description content="How to rename index patterns in Kibana without breaking your existing visualizations or dashboards."><meta name=twitter:site content="@https://twitter.com/jorgelbg"></head><body><section id=wrapper><nav class=main-nav><a href=//jorgelbg.me></a></nav><article class=post><header><h1><a href=/2019/05/how-to-rename-index-patterns-in-kibana/><svg width="30" xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 483 483"><path d="M255 209c-5 6-5 14 0 19 22 22 22 58 0 80L140 423a56 56 0 01-79 0l-18-17a56 56 0 010-80l115-115c6-5 6-14 1-19s-14-5-20 0L24 307a83 83 0 000 118l18 17a83 83 0 00117 0l115-115c33-32 33-85 0-118-5-5-13-5-19 0z"/><path d="M459 58l-18-17a83 83 0 00-117 0L209 156a83 83 0 000 118c5 5 13 5 19 0s5-14 0-20a56 56 0 010-79L343 60c22-22 57-22 79 0l17 17c22 22 22 58 0 80L324 272c-5 5-5 13 0 19 3 2 7 4 10 4s7-1 9-4l115-115a83 83 0 001-118z"/></svg>How to rename index patterns in Kibana</a></h1><h2 class=headline><span>May 21, 2019</span>
<span class=tag><svg fill="#718096" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16"><path class="heroicon-ui" d="M2.59 13.41A1.98 1.98.0 012 12V7a5 5 0 015-5h4.99c.53.0 1.04.2 1.42.59l8 8a2 2 0 010 2.82l-8 8a2 2 0 01-2.82.0l-8-8zM20 12l-8-8H7A3 3 0 004 7v5l8 8 8-8zM7 8a1 1 0 110-2 1 1 0 010 2z"/></svg><a style=margin-left:10px href=//jorgelbg.me/tags/kibana>kibana</a></span>
<span class=tag><svg fill="#718096" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16"><path class="heroicon-ui" d="M2.59 13.41A1.98 1.98.0 012 12V7a5 5 0 015-5h4.99c.53.0 1.04.2 1.42.59l8 8a2 2 0 010 2.82l-8 8a2 2 0 01-2.82.0l-8-8zM20 12l-8-8H7A3 3 0 004 7v5l8 8 8-8zM7 8a1 1 0 110-2 1 1 0 010 2z"/></svg><a style=margin-left:10px href=//jorgelbg.me/tags/index-pattern>index-pattern</a></span></h2><p class=last-edited><a href=https://github.com/jorgelbg/jorgelbg.github.io/commit/efca25d7743ff154a7e9707874108943d760302e title="Fix type in the Kibana renaming index pattern article">Last edited on 9 December 2019</a></p></header><section id=post-body><p>If you have been using Kibana long enough you probably have a large collection
of visualizations and dashboards already created. From time to time you may have
a need to <em>rename</em> an already index pattern. Turns out that Kibana doesn't
support this. You can refresh the index pattern and you can drop it but that's
it. There is an [open issue in Github]
(<a href=https://github.com/elastic/kibana/issues/17542>https://github.com/elastic/kibana/issues/17542</a>) to address this issue, but it
is still open at the time of writing this post.</p><p>To be clear, let's assume that, for the scope of this post, you have an index
pattern called <code>logstash*</code> that matches your daily indices (<code>logstash-%Y.%m.%d</code>)
<code>logstash-2019.04.03</code>. <code>logstash-2019.04.05</code>, etc. But now you start ingesting
data for your <code>dev</code> environment and the new indexes follow the pattern
<code>logstash_dev-%Y.%m.%d</code>. We can see that the old index pattern will also match
the new events. In a perfect world you have your index patterns as specific as
possible to avoid this issues, but if you're working on a legacy system you may
not be able to foresee this issue from the beginning.</p><p>You may want to drop the index pattern and create it again but if you're using a
recent version of Kibana, the <code>_id</code> of the index pattern is different than the
<code>title</code> or <code>name</code>. This means that when you drop the index pattern you
visualizations will have broken, pointing to an index pattern that no longer
exists. If you have defined some <a href=https://www.elastic.co/guide/en/kibana/current/scripted-fields.html>scripted
fields</a>
these will be also lost. If you do this, you may <a href=https://github.com/elastic/beats/issues/10117>run into some
issues</a>.</p><p>The proposed workflow is to export the exact object that we need (an index
pattern) update it with the new pattern, delete the old copy and import it
again. The advantage of this approach is that since we're importing an index it
will keep the old <code>_id</code> field, which means that all your old
visualizations/dashboards will continue to work.</p><blockquote><p>Normally on the <a href=https://www.elastic.co/guide/en/kibana/current/managing-saved-objects.html>Kibana Saved
Objects</a>
section you can edit the raw JSON of the visualizations/dashboards. But for
some reason they don't allow the same for the index patterns. If you click on
the index pattern it will just redirect you to the &ldquo;Index patterns&rdquo; section.
In this section you cannot (unfortunately) edit the title/name of the index
pattern.</p></blockquote><h2 id=step-by-step-guide>Step by step guide</h2><p>First, let's export the index pattern that we want to update</p><p><img src=/posts/2019/rename-kibana-index-patterns/export-ui.png alt="Index pattern export"></p><p>Open the JSON file with all the saved index patterns and (for safety) remove all
other index patterns, except the one that you need. You may end up with a JSON
similar to:</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>[</span>
  <span class=p>{</span>
    <span class=nt>&#34;_id&#34;</span><span class=p>:</span> <span class=s2>&#34;ehtekygbbnvfb0&#34;</span><span class=p>,</span>
    <span class=nt>&#34;_type&#34;</span><span class=p>:</span> <span class=s2>&#34;index-pattern&#34;</span><span class=p>,</span>
    <span class=nt>&#34;_source&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;notExpandable&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nt>&#34;timeFieldName&#34;</span><span class=p>:</span> <span class=s2>&#34;@timestamp&#34;</span><span class=p>,</span>
      <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;logstash*&#34;</span><span class=p>,</span>
      <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=s2>&#34;[{\&#34;name\&#34;:\&#34;@timestamp\&#34;,\&#34;type\&#34;:\&#34;date\&#34;,
</span><span class=s2>        \&#34;count\&#34;:0,\&#34;scripted\&#34;:false,
</span><span class=s2>        \&#34;searchable\&#34;:true,\&#34;aggregatable\&#34;:true,
</span><span class=s2>        \&#34;readFromDocValues\&#34;:true}]&#34;</span>
        <span class=err>.</span><span class=err>.</span><span class=err>.</span>
    <span class=p>}</span><span class=p>,</span>
    <span class=nt>&#34;_meta&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;savedObjectVersion&#34;</span><span class=p>:</span> <span class=mi>2</span>
    <span class=p>}</span><span class=p>,</span>
    <span class=nt>&#34;_migrationVersion&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;index-pattern&#34;</span><span class=p>:</span> <span class=s2>&#34;6.5.0&#34;</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>]</span>
</code></pre></div><p>Now you can edit the <code>title</code> field to match the new index pattern, in our case
this could be <code>logstash-*</code>. Since we include the <code>-</code> we're making sure that the
<code>logstash_dev*</code> indices are not matched by this index pattern. You may end up
with a JSON file similar to:</p><div class=highlight><pre class=chroma><code class=language-json data-lang=json><span class=p>[</span>
  <span class=p>{</span>
<span class=hl>    <span class=nt>&#34;_id&#34;</span><span class=p>:</span> <span class=s2>&#34;ehtekygbbnvfb0&#34;</span><span class=p>,</span>
</span>    <span class=nt>&#34;_type&#34;</span><span class=p>:</span> <span class=s2>&#34;index-pattern&#34;</span><span class=p>,</span>
    <span class=nt>&#34;_source&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;notExpandable&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nt>&#34;timeFieldName&#34;</span><span class=p>:</span> <span class=s2>&#34;@timestamp&#34;</span><span class=p>,</span>
<span class=hl>      <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;logstash-*&#34;</span><span class=p>,</span>
</span>      <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=s2>&#34;[{\&#34;name\&#34;:\&#34;@timestamp\&#34;,\&#34;type\&#34;:\&#34;date\&#34;,
</span><span class=s2>        \&#34;count\&#34;:0,\&#34;scripted\&#34;:false,
</span><span class=s2>        \&#34;searchable\&#34;:true,\&#34;aggregatable\&#34;:true,
</span><span class=s2>        \&#34;readFromDocValues\&#34;:true}]&#34;</span>
        <span class=err>.</span><span class=err>.</span><span class=err>.</span>
    <span class=p>}</span><span class=p>,</span>
    <span class=nt>&#34;_meta&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;savedObjectVersion&#34;</span><span class=p>:</span> <span class=mi>2</span>
    <span class=p>}</span><span class=p>,</span>
    <span class=nt>&#34;_migrationVersion&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;index-pattern&#34;</span><span class=p>:</span> <span class=s2>&#34;6.5.0&#34;</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>]</span></code></pre></div><p>It is very important to keep the same <code>_id</code>. This is the field that Kibana will
use to know which index pattern the visualizations will query.</p><p>Delete your old index pattern.</p><p>Import the new index pattern by clicking on the Import icon on the Kibana Saved
objects section and dragging your edited JSON into the UI.</p><p><img src=/posts/2019/rename-kibana-index-patterns/import-ui.png alt="Saved Objects importUI"></p><p>At this point, if you open your old dashboards everything should be working as
before.</p><h2 id=summary>Summary</h2><p>TBH this is, simply put, a workaround. This a feature that I expected Kibana
offered out of the box. If not baked into the UI at least through the edition of
the Saved Objects UI. Sadly this is not the case.</p><p>I've oriented this post around using Kibana since, the <a href=https://www.elastic.co/guide/en/kibana/current/dashboard-import-api-import.html>import
API</a>
for exporting and importing the saved objects validates the data. The same is
posible by using the Elasticsearch API (modifying the documents directly).</p><div class=info><svg width="50" version="1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 0A246 246 0 0075 413l-13 88a10 10 0 0014 10l79-41A246 246 0 10256 0zm0 472c-34 0-67-7-97-22-3-1-6-1-9 1l-66 34 11-74c1-3 0-6-2-8a227 227 0 11163 70z"/><path d="M256 71a51 51 0 100 102 51 51 0 000-102zm0 83a32 32 0 110-64 32 32 0 010 64zm57 204h-11V199c0-5-5-10-10-10h-93c-5 0-9 5-9 10v32c0 6 4 10 9 10h11v117h-11c-5 0-9 4-9 9v33c0 5 4 9 9 9h114c5 0 9-4 9-9v-33c0-5-4-9-9-9zm-10 32h-94v-13h11c5 0 10-4 10-10V231c0-5-5-9-10-9h-11v-13h73v158c0 6 5 10 10 10h11v13z"/></svg><p>If you want to know more about the structure of the documents that Kibana
persists in ES (for its internal use) you should check <a href=https://www.elastic.co/blog/kibana-under-the-hood-object-persistence>this blog
post</a></p></div></section></article><footer id=post-meta class=clearfix><svg class="avatar" width="50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="#cbd5e0" d="M20.3 12.04l1.01 3a1 1 0 01-1.26 1.27l-3.01-1a7 7 0 113.27-3.27zM11 10a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2zm3 0a1 1 0 100-2 1 1 0 000 2z"/><path fill="#4a5568" d="M15.88 17.8a7 7 0 01-8.92 2.5l-3 1.01a1 1 0 01-1.27-1.26l1-3.01A6.97 6.97.0 015 9.1a9 9 0 0010.88 8.7z"/></svg><a href=https://twitter.com/jorgelbg><div><span class=dark>Want to leave a comment?</span>
<span>Drop me a message on Twitter @jorgelbg</span></div></a><section id=sharing><a class=twitter target=_blank href="https://twitter.com/intent/tweet?text=%2f%2fjorgelbg.me%2f2019%2f05%2fhow-to-rename-index-patterns-in-kibana%2f - How%20to%20rename%20index%20patterns%20in%20Kibana by @jorgelbg"><span class=icon-twitter>tweet</span></a></section></footer><ul id=post-list class="archive readmore"><h3>Read more</h3><li><a href=/2019/03/useful-alerts-with-elastic-watcher-machine-learning/><span>Useful alerts with Elastic Watcher & Machine Learning</span><aside class=dates>Mar 15 2019</aside></a></li><li><a href=/2019/02/display-the-applications-version-in-your-grafana-dashboards/><span>Display the application's version in your Grafana dashboards</span><aside class=dates>Feb 17 2019</aside></a></li><li><a href=/2018/12/optimize-grafana-dashboards-with-elasticsearch-index-aliases/><span>Optimize Grafana dashboards with Elasticsearch index aliases</span><aside class=dates>Dec 20 2018</aside></a></li></ul><footer id=footer><p class=small>© Copyright 2020 Jorge Luis Betancourt</p><p class="small cc">Icons made by
<a href=https://www.freepik.com/ title=Freepik>Freepik</a> from
<a href=https://www.flaticon.com/ title=Flaticon>www.flaticon.com</a> is
licensed by
<a href=https://creativecommons.org/licenses/by/3.0/ title="Creative Commons BY 3.0" target=_blank>CC 3.0 BY</a></p></footer></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-115201846-1','auto');ga('send','pageview');}</script></body></html>